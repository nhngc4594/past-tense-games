<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irregular Verb Master Game</title>
   <style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background-color: #e3f2fd; /* Soft Blue Background */
        margin: 0;
        text-align: center;
    }
    #game-container {
        background-color: #e3f2fd;
        padding: 30px;
        border-radius: 12px;
        width: 90%;
        max-width: 600px;
    }
    h2 {
        color: #333;
        margin-bottom: 20px;
    }
    .verb-display {
        font-size: 2.5em;
        font-weight: bold;
        color: #ffc0cb; /* Sakura Pink */
        cursor: pointer;
        padding: 10px 20px;
        border: 2px solid #ffc0cb;
        border-radius: 8px;
        display: inline-block;
        margin-bottom: 10px;
        user-select: none;
    }
    .verb-display:active {
        transform: scale(0.98);
    }
    #translation {
        font-size: 1.2em;
        color: #555;
        margin-bottom: 20px;
    }
    #question-text {
        font-size: 1.1em;
        color: #777;
        margin-bottom: 25px;
    }
    .past-tense-reveal {
        font-size: 2em;
        font-weight: bold;
        color: #ffc0cb;
        cursor: pointer;
        padding: 5px 10px;
        display: inline-block;
        margin-top: 15px;
        border-bottom: 3px dashed #ffc0cb;
        user-select: none;
    }
    .past-tense-reveal:active {
        opacity: 0.8;
    }
    .button-group button,
    #reveal-button,
    #start-game-button,
    #round-summary-view button {
        background-color: #ffc0cb; /* Sakura Pink Button Color */
        color: #333; /* Dark text for contrast */
        border: none;
        padding: 12px 25px;
        margin: 5px;
        border-radius: 5px;
        font-size: 1em;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    .button-group button:hover,
    #reveal-button:hover,
    #start-game-button:hover,
    #round-summary-view button:hover {
        background-color: #f7a9b8;
    }
    /* Make specific buttons larger */
    #reveal-button, #start-game-button {
        padding: 15px 40px !important;
        font-size: 1.2em !important;
        font-weight: bold;
        min-width: 250px;
    }
    .score-box {
        margin-top: 20px;
        font-size: 1.2em;
        color: #333;
    }
    #round-summary {
        margin-top: 20px;
        text-align: left;
        padding: 15px;
        background-color: #fff; /* White background for summary box */
        border-radius: 8px;
    }
    .summary-item {
        margin-bottom: 10px;
        font-size: 0.95em;
    }
    .hidden {
        display: none;
    }
    /* Style for Instructions screen */
    #instructions-view {
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    #instructions-view ul {
        list-style: none;
        padding-left: 0;
        max-width: 450px;
        margin: 0 auto 20px auto;
        text-align: left;
    }
    #instructions-view li {
        margin-bottom: 10px;
        line-height: 1.4;
    }
    #instructions-view h3 {
        color: #ffc0cb; /* Sakura Pink */
    }
    .instruction-section {
        margin-bottom: 25px;
        text-align: center;
    }
    .instruction-title {
        font-weight: bold;
        color: #e91e63;
        margin-bottom: 10px;
        font-size: 1.1em;
        text-align: center;
    }
</style>
</head>
<body>

<div id="instructions-view">
    <h2 style="color: #e91e63;">ä¸è¦å‰‡å‹•è©ãƒã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒ </h2>
    
    <div class="instruction-section">
        <div class="instruction-title">æ—¥æœ¬èªã§ã®éŠã³æ–¹:</div>
        <p>ã“ã®ã‚²ãƒ¼ãƒ ã¯ã€ä¸è¦å‰‡å‹•è©ã®éå»å½¢ã¨éå»åˆ†è©å½¢ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        <p style="font-weight: bold;">10ãƒ©ã‚¦ãƒ³ãƒ‰ã§100å˜èªã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã™ã€‚</p>
        <ul>
            <li>ã‚¹ãƒ†ãƒƒãƒ—1: å˜èªãŒè‡ªå‹•çš„ã«å†ç”Ÿã•ã‚Œã¾ã™ã€‚</li>
            <li>ã‚¹ãƒ†ãƒƒãƒ—2: éå»å½¢ã¨éå»åˆ†è©å½¢ã‚’è€ƒãˆã¾ã™ã€‚</li>
            <li>ã‚¹ãƒ†ãƒƒãƒ—3: ã€ŒSimple Pastã€ã¨ã€ŒPast Participleã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
            <li>ã‚¹ãƒ†ãƒƒãƒ—4: ã€ŒYes, No, Not Sureã€ã§å›ç­”ã—ã€ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã—ã¾ã™ã€‚</li>
            <li>ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†: ã‚¹ã‚³ã‚¢ã¨10å˜èªå…¨ã¦ã®ä¾‹æ–‡ã‚’ç¢ºèªã—ã¾ã™ã€‚</li>
        </ul>
    </div>
    
    <button id="start-game-button" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
</div>

        <div class="instruction-section">
            <div class="instruction-title">æ—¥æœ¬èªã§ã®éŠã³æ–¹:</div>
            <p>ã“ã®ã‚²ãƒ¼ãƒ ã¯ã€ä¸è¦å‰‡å‹•è©ã®ä¸‰ã¤ã®å½¢ï¼ˆåŸå½¢ã€éå»å½¢ã€éå»åˆ†è©ï¼‰ã®çŸ¥è­˜ã‚’è©¦ã—ã¾ã™ã€‚</p>
            <p style="font-weight: bold;">1ãƒ©ã‚¦ãƒ³ãƒ‰10å˜èªã€å…¨10ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã™ã€‚</p>
            <ul>
                <li>ã‚¹ãƒ†ãƒƒãƒ—1: å‹•è©ï¼ˆåŸå½¢ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç™ºéŸ³ã‚’èãã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—2: éå»å½¢ã‚’è€ƒãˆã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—3: ã€ŒSimple Pastã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç­”ãˆã‚’ç¢ºèªã—ã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—4: éå»åˆ†è©ã‚’è€ƒãˆã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—5: ã€ŒPast Participleã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç­”ãˆã‚’ç¢ºèªã—ã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—6: ã€ŒYes, No, Not Sureã€ã§å›ç­”ã—ã€ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã—ã¾ã™ã€‚</li>
                <li>ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†: ã‚¹ã‚³ã‚¢ã¨10å˜èªå…¨ã¦ã®ä¾‹æ–‡ã‚’ç¢ºèªã—ã¾ã™ã€‚</li>
            </ul>
        </div>
        
        <button id="start-game-button" onclick="startGame()">Start Game</button>
    </div>

    <div id="current-word-view" class="hidden">
        <h2 id="round-header">Round 1: Word 1 / 10</h2>
        
        <div id="translation">[Japanese Definition]</div>
        <div id="infinitive-verb-display" onclick="speakText(currentWord.infinitive)">INFINITIVE VERB</div>
        <div id="question-text">Click the verb to hear it. **What is its Simple Past form?**</div>
        
        <button id="reveal-simple-past-button" onclick="revealSimplePast()">Simple Past</button>
        
        <div id="simple-past-container" class="hidden">
            <div id="simple-past-display" class="past-tense-reveal" onclick="speakText(currentWord.simple_past)"></div>
            <p style="margin-top: 20px; color: #333;">**Next: What is the Past Participle form?**</p>
            
            <button id="reveal-past-participle-button" onclick="revealPastParticiple()">Past Participle</button>

            <div id="past-participle-container" class="hidden">
                <div id="past-participle-display" class="past-tense-reveal" onclick="speakText(currentWord.past_participle)"></div>
                <p style="margin-top: 20px; color: #333;">Is this what you thought?</p>
                <div id="feedback-buttons" class="button-group">
                    <button onclick="submitFeedback(1)">Yes <span id="reward-visual"></span></button>
                    <button onclick="submitFeedback(0.5)">Not Sure</button>
                    <button onclick="submitFeedback(0)">No</button>
                </div>
            </div>
        </div>
    </div>

    <div id="round-summary-view" class="hidden">
        <h3>Round <span id="summary-round-number"></span> Complete!</h3>
        <div class="score-box">
            Round Score: <span id="round-score-display">0</span> <span style="font-size: 1.5em;">ğŸª™</span>
        </div>
        <h4>Summary of Verb Forms:</h4>
        <div id="round-summary"></div>
        <button onclick="startNextRound()">Start Next Round</button>
    </div>

    <div class="score-box">
        Total Score: <span id="total-score-display">0</span> <span style="font-size: 1.5em;">ğŸ¥‡</span>
    </div>
</div>

<script>
// =======================================================================
// PART 1: GAME DATA (100 Common Irregular Verbs)
// =======================================================================

const IRREGULAR_GAME_DATA = [
    {
        "round_number": 1,
        "words": [
            { "infinitive": "BE", "simple_past": "was were", "past_participle": "been", "japanese_def": "[ã€œã§ã‚ã‚‹]", "sample_sentence": "She has been waiting for an hour." },
            { "infinitive": "GO", "simple_past": "went", "past_participle": "gone", "japanese_def": "[è¡Œã]", "sample_sentence": "They have gone to the new restaurant." },
            { "infinitive": "DO", "simple_past": "did", "past_participle": "done", "japanese_def": "[ã™ã‚‹]", "sample_sentence": "I have done my best on this project." },
            { "infinitive": "GET", "simple_past": "got", "past_participle": "gotten", "japanese_def": "[å¾—ã‚‹]", "sample_sentence": "He has gotten much better at guitar." },
            { "infinitive": "SAY", "simple_past": "said", "past_participle": "said", "japanese_def": "[è¨€ã†]", "sample_sentence": "She has said that many times before." },
            { "infinitive": "MAKE", "simple_past": "made", "past_participle": "made", "japanese_def": "[ä½œã‚‹]", "sample_sentence": "They have made a big improvement." },
            { "infinitive": "TAKE", "simple_past": "took", "past_participle": "taken", "japanese_def": "[å–ã‚‹]", "sample_sentence": "The plane has taken off already." },
            { "infinitive": "SEE", "simple_past": "saw", "past_participle": "seen", "japanese_def": "[è¦‹ã‚‹]", "sample_sentence": "We have seen that movie three times." },
            { "infinitive": "COME", "simple_past": "came", "past_participle": "come", "japanese_def": "[æ¥ã‚‹]", "sample_sentence": "The time has come to say goodbye." },
            { "infinitive": "KNOW", "simple_past": "knew", "past_participle": "known", "japanese_def": "[çŸ¥ã£ã¦ã„ã‚‹]", "sample_sentence": "I have known him since elementary school." }
        ]
    },
    {
        "round_number": 2,
        "words": [
            { "infinitive": "GIVE", "simple_past": "gave", "past_participle": "given", "japanese_def": "[ä¸ãˆã‚‹]", "sample_sentence": "She has given a clear explanation." },
            { "infinitive": "FIND", "simple_past": "found", "past_participle": "found", "japanese_def": "[è¦‹ã¤ã‘ã‚‹]", "sample_sentence": "We have found the missing key." },
            { "infinitive": "THINK", "simple_past": "thought", "past_participle": "thought", "japanese_def": "[è€ƒãˆã‚‹]", "sample_sentence": "I had thought it would be easier." },
            { "infinitive": "TELL", "simple_past": "told", "past_participle": "told", "japanese_def": "[è©±ã™]", "sample_sentence": "He has told the whole story now." },
            { "infinitive": "PUT", "simple_past": "put", "past_participle": "put", "japanese_def": "[ç½®ã]", "sample_sentence": "She has put the books on the shelf." },
            { "infinitive": "MEAN", "simple_past": "meant", "past_participle": "meant", "japanese_def": "[æ„å‘³ã™ã‚‹]", "sample_sentence": "I hadn't meant to cause any trouble." },
            { "infinitive": "KEEP", "simple_past": "kept", "past_participle": "kept", "japanese_def": "[ä¿ã¤]", "sample_sentence": "We have kept this secret for years." },
            { "infinitive": "LET", "simple_past": "let", "past_participle": "let", "japanese_def": "[è¨±ã™]", "sample_sentence": "My parents have always let me travel." },
            { "infinitive": "BEGIN", "simple_past": "began", "past_participle": "begun", "japanese_def": "[å§‹ã‚ã‚‹]", "sample_sentence": "The concert has begun, please take your seats." },
            { "infinitive": "SHOW", "simple_past": "showed", "past_participle": "shown", "japanese_def": "[è¦‹ã›ã‚‹]", "sample_sentence": "They have shown great courage." }
        ]
    },
    {
        "round_number": 3,
        "words": [
            { "infinitive": "HEAR", "simple_past": "heard", "past_participle": "heard", "japanese_def": "[èã]", "sample_sentence": "I have heard that rumor before." },
            { "infinitive": "RUN", "simple_past": "ran", "past_participle": "run", "japanese_def": "[èµ°ã‚‹]", "sample_sentence": "He has run the marathon twice." },
            { "infinitive": "HOLD", "simple_past": "held", "past_participle": "held", "japanese_def": "[æŒã¤]", "sample_sentence": "She has held the record since 2010." },
            { "infinitive": "BRING", "simple_past": "brought", "past_participle": "brought", "japanese_def": "[æŒã£ã¦ãã‚‹]", "sample_sentence": "We have brought enough food for everyone." },
            { "infinitive": "WRITE", "simple_past": "wrote", "past_participle": "written", "japanese_def": "[æ›¸ã]", "sample_sentence": "The book was written in 1899." },
            { "infinitive": "SIT", "simple_past": "sat", "past_participle": "sat", "japanese_def": "[åº§ã‚‹]", "sample_sentence": "I have sat here for half an hour." },
            { "infinitive": "STAND", "simple_past": "stood", "past_participle": "stood", "japanese_def": "[ç«‹ã¤]", "sample_sentence": "He has stood by his decision." },
            { "infinitive": "LOSE", "simple_past": "lost", "past_participle": "lost", "japanese_def": "[å¤±ã†]", "sample_sentence": "They have lost the championship game." },
            { "infinitive": "PAY", "simple_past": "paid", "past_participle": "paid", "japanese_def": "[æ”¯æ‰•ã†]", "sample_sentence": "We have paid all our debts." },
            { "infinitive": "MEET", "simple_past": "met", "past_participle": "met", "japanese_def": "[ä¼šã†]", "sample_sentence": "I haven't met your new boss yet." }
        ]
    },
    {
        "round_number": 4,
        "words": [
            { "infinitive": "SET", "simple_past": "set", "past_participle": "set", "japanese_def": "[ç½®ã/è¨­å®šã™ã‚‹]", "sample_sentence": "The alarm has been set for 6 AM." },
            { "infinitive": "LEAD", "simple_past": "led", "past_participle": "led", "japanese_def": "[å°ã]", "sample_sentence": "She has led the team for three years." },
            { "infinitive": "UNDERSTAND", "simple_past": "understood", "past_participle": "understood", "japanese_def": "[ç†è§£ã™ã‚‹]", "sample_sentence": "I hadn't understood the gravity of the situation." },
            { "infinitive": "SPEAK", "simple_past": "spoke", "past_participle": "spoken", "japanese_def": "[è©±ã™]", "sample_sentence": "They have spoken to the manager." },
            { "infinitive": "READ", "simple_past": "read", "past_participle": "read", "japanese_def": "[èª­ã‚€]", "sample_sentence": "She has read that book many times." },
            { "infinitive": "SPEND", "simple_past": "spent", "past_participle": "spent", "japanese_def": "[è²»ã‚„ã™]", "sample_sentence": "We have spent all our savings." },
            { "infinitive": "GROW", "simple_past": "grew", "past_participle": "grown", "japanese_def": "[è‚²ã¤]", "sample_sentence": "The children have grown so tall." },
            { "infinitive": "WIN", "simple_past": "won", "past_participle": "won", "japanese_def": "[å‹ã¤]", "sample_sentence": "Our team has won every game this season." },
            { "infinitive": "BUY", "simple_past": "bought", "past_participle": "bought", "japanese_def": "[è²·ã†]", "sample_sentence": "I have bought a new phone." },
            { "infinitive": "SEND", "simple_past": "sent", "past_participle": "sent", "japanese_def": "[é€ã‚‹]", "sample_sentence": "The package has been sent." }
        ]
    },
    {
        "round_number": 5,
        "words": [
            { "infinitive": "BUILD", "simple_past": "built", "past_participle": "built", "japanese_def": "[å»ºã¦ã‚‹]", "sample_sentence": "They have built a strong company." },
            { "infinitive": "FALL", "simple_past": "fell", "past_participle": "fallen", "japanese_def": "[è½ã¡ã‚‹]", "sample_sentence": "The leaves have fallen from the trees." },
            { "infinitive": "CUT", "simple_past": "cut", "past_participle": "cut", "japanese_def": "[åˆ‡ã‚‹]", "sample_sentence": "She has cut her hair short." },
            { "infinitive": "EAT", "simple_past": "ate", "past_participle": "eaten", "japanese_def": "[é£Ÿã¹ã‚‹]", "sample_sentence": "We have eaten all the pizza." },
            { "infinitive": "DRINK", "simple_past": "drank", "past_participle": "drunk", "japanese_def": "[é£²ã‚€]", "sample_sentence": "He has drunk three glasses of water." },
            { "infinitive": "FORGET", "simple_past": "forgot", "past_participle": "forgotten", "japanese_def": "[å¿˜ã‚Œã‚‹]", "sample_sentence": "I had forgotten my wallet at home." },
            { "infinitive": "TEACH", "simple_past": "taught", "past_participle": "taught", "japanese_def": "[æ•™ãˆã‚‹]", "sample_sentence": "She has taught for over twenty years." },
            { "infinitive": "CATCH", "simple_past": "caught", "past_participle": "caught", "japanese_def": "[æ•ã¾ãˆã‚‹]", "sample_sentence": "He has caught every ball thrown to him." },
            { "infinitive": "SLEEP", "simple_past": "slept", "past_participle": "slept", "japanese_def": "[çœ ã‚‹]", "sample_sentence": "I have slept well since moving here." },
            { "infinitive": "DRIVE", "simple_past": "drove", "past_participle": "driven", "japanese_def": "[é‹è»¢ã™ã‚‹]", "sample_sentence": "She has driven across the entire country." }
        ]
    },
    {
        "round_number": 6,
        "words": [
            { "infinitive": "HAVE", "simple_past": "had", "past_participle": "had", "japanese_def": "[æŒã¤]", "sample_sentence": "They have had a great vacation." },
            { "infinitive": "WIN", "simple_past": "won", "past_participle": "won", "japanese_def": "[å‹ã¤]", "sample_sentence": "Our team has won the league." },
            { "infinitive": "LEAVE", "simple_past": "left", "past_participle": "left", "japanese_def": "[å»ã‚‹]", "sample_sentence": "He has left the office already." },
            { "infinitive": "STAND", "simple_past": "stood", "past_participle": "stood", "japanese_def": "[ç«‹ã¤]", "sample_sentence": "We have stood for hours at the concert." },
            { "infinitive": "FEEL", "simple_past": "felt", "past_participle": "felt", "japanese_def": "[æ„Ÿã˜ã‚‹]", "sample_sentence": "I haven't felt this happy in years." },
            { "infinitive": "BREAK", "simple_past": "broke", "past_participle": "broken", "japanese_def": "[å£Šã™]", "sample_sentence": "The glass has been broken." },
            { "infinitive": "WEAR", "simple_past": "wore", "past_participle": "worn", "japanese_def": "[ç€ã‚‹]", "sample_sentence": "She has worn that dress once before." },
            { "infinitive": "CHOOSE", "simple_past": "chose", "past_participle": "chosen", "japanese_def": "[é¸ã¶]", "sample_sentence": "They have chosen a new leader." },
            { "infinitive": "THROW", "simple_past": "threw", "past_participle": "thrown", "japanese_def": "[æŠ•ã’ã‚‹]", "sample_sentence": "The ball was thrown out of bounds." },
            { "infinitive": "BITE", "simple_past": "bit", "past_participle": "bitten", "japanese_def": "[å™›ã‚€]", "sample_sentence": "I have been bitten by a mosquito." }
        ]
    },
    {
        "round_number": 7,
        "words": [
            { "infinitive": "RING", "simple_past": "rang", "past_participle": "rung", "japanese_def": "[é³´ã‚‹]", "sample_sentence": "The phone has rung ten times today." },
            { "infinitive": "SING", "simple_past": "sang", "past_participle": "sung", "japanese_def": "[æ­Œã†]", "sample_sentence": "She has sung that song beautifully." },
            { "infinitive": "SWIM", "simple_past": "swam", "past_participle": "swum", "japanese_def": "[æ³³ã]", "sample_sentence": "We have swum in this lake many times." },
            { "infinitive": "FIGHT", "simple_past": "fought", "past_participle": "fought", "japanese_def": "[æˆ¦ã†]", "sample_sentence": "They have fought for their rights." },
            { "infinitive": "STEAL", "simple_past": "stole", "past_participle": "stolen", "japanese_def": "[ç›—ã‚€]", "sample_sentence": "My bike has been stolen." },
            { "infinitive": "SHAKE", "simple_past": "shook", "past_participle": "shaken", "japanese_def": "[æŒ¯ã‚‹]", "sample_sentence": "The earthquake has shaken the building." },
            { "infinitive": "FLY", "simple_past": "flew", "past_participle": "flown", "japanese_def": "[é£›ã¶]", "sample_sentence": "He has flown a plane solo." },
            { "infinitive": "HIDE", "simple_past": "hid", "past_participle": "hidden", "japanese_def": "[éš ã™]", "sample_sentence": "The treasure has been hidden for centuries." },
            { "infinitive": "WAKE", "simple_past": "woke", "past_participle": "woken", "japanese_def": "[ç›®è¦šã‚ã‚‹]", "sample_sentence": "I have been woken up by the noise." },
            { "infinitive": "FREEZE", "simple_past": "froze", "past_participle": "frozen", "japanese_def": "[å‡ã‚‹]", "sample_sentence": "The water pipes have frozen solid." }
        ]
    },
    {
        "round_number": 8,
        "words": [
            { "infinitive": "DRAW", "simple_past": "drew", "past_participle": "drawn", "japanese_def": "[æã]", "sample_sentence": "She has drawn a beautiful picture." },
            { "infinitive": "SHINE", "simple_past": "shone", "past_participle": "shone", "japanese_def": "[è¼ã]", "sample_sentence": "The sun has shone all day." },
            { "infinitive": "DEAL", "simple_past": "dealt", "past_participle": "dealt", "japanese_def": "[å¯¾å‡¦ã™ã‚‹]", "sample_sentence": "They have dealt with that issue before." },
            { "infinitive": "SWEEP", "simple_past": "swept", "past_participle": "swept", "japanese_def": "[æƒã]", "sample_sentence": "The floor has been swept clean." },
            { "infinitive": "TEAR", "simple_past": "tore", "past_participle": "torn", "japanese_def": "[ç ´ã‚‹]", "sample_sentence": "The paper has been torn in half." },
            { "infinitive": "LEND", "simple_past": "lent", "past_participle": "lent", "japanese_def": "[è²¸ã™]", "sample_sentence": "I have lent him money many times." },
            { "infinitive": "HURT", "simple_past": "hurt", "past_participle": "hurt", "japanese_def": "[å‚·ã¤ã‘ã‚‹]", "sample_sentence": "He has hurt his knee playing soccer." },
            { "infinitive": "STICK", "simple_past": "stuck", "past_participle": "stuck", "japanese_def": "[å›ºåŸ·ã™ã‚‹/ãã£ã¤ã]", "sample_sentence": "The key has stuck in the lock." },
            { "infinitive": "DIG", "simple_past": "dug", "past_participle": "dug", "japanese_def": "[æ˜ã‚‹]", "sample_sentence": "They have dug a hole for the tree." },
            { "infinitive": "SELL", "simple_past": "sold", "past_participle": "sold", "japanese_def": "[å£²ã‚‹]", "sample_sentence": "The house was sold last month." }
        ]
    },
    {
        "round_number": 9,
        "words": [
            { "infinitive": "FORBID", "simple_past": "forbade", "past_participle": "forbidden", "japanese_def": "[ç¦ã˜ã‚‹]", "sample_sentence": "Smoking is strictly forbidden here." },
            { "infinitive": "FORGIVE", "simple_past": "forgave", "past_participle": "forgiven", "japanese_def": "[è¨±ã™]", "sample_sentence": "She has been forgiven for her error." },
            { "infinitive": "PROVE", "simple_past": "proved", "past_participle": "proven", "japanese_def": "[è¨¼æ˜ã™ã‚‹]", "sample_sentence": "The theory has been proven correct." },
            { "infinitive": "RISE", "simple_past": "rose", "past_participle": "risen", "japanese_def": "[ä¸ŠãŒã‚‹]", "sample_sentence": "The sun has already risen." },
            { "infinitive": "SHUT", "simple_past": "shut", "past_participle": "shut", "japanese_def": "[é–‰ã‚ã‚‹]", "sample_sentence": "The shop is shut for the day." },
            { "infinitive": "SINK", "simple_past": "sank", "past_participle": "sunk", "japanese_def": "[æ²ˆã‚€]", "sample_sentence": "The ship has sunk to the ocean floor." },
            { "infinitive": "SMELL", "simple_past": "smelled", "past_participle": "smelled", "japanese_def": "[åŒ‚ã„ã‚’ã‹ã]", "sample_sentence": "It smelled strongly of garlic." },
            { "infinitive": "STRIKE", "simple_past": "struck", "past_participle": "struck", "japanese_def": "[æ‰“ã¤/è¥²ã†]", "sample_sentence": "Lightning has struck the same place twice." },
            { "infinitive": "WEEP", "simple_past": "wept", "past_participle": "wept", "japanese_def": "[æ³£ã]", "sample_sentence": "She has wept tears of joy." },
            { "infinitive": "WITHDRAW", "simple_past": "withdrew", "past_participle": "withdrawn", "japanese_def": "[å¼•ãå‡ºã™]", "sample_sentence": "He has withdrawn all his money." }
        ]
    },
    {
        "round_number": 10,
        "words": [
            { "infinitive": "BEND", "simple_past": "bent", "past_participle": "bent", "japanese_def": "[æ›²ã’ã‚‹]", "sample_sentence": "The pole has been bent by the wind." },
            { "infinitive": "BLEED", "simple_past": "bled", "past_participle": "bled", "japanese_def": "[å‡ºè¡€ã™ã‚‹]", "sample_sentence": "The wound has stopped bleeding." },
            { "infinitive": "BREED", "simple_past": "bred", "past_participle": "bred", "japanese_def": "[ç¹æ®–ã•ã›ã‚‹]", "sample_sentence": "These dogs have been bred for speed." },
            { "infinitive": "CLING", "simple_past": "clung", "past_participle": "clung", "japanese_def": "[ã—ãŒã¿ã¤ã]", "sample_sentence": "The child clung to her mother." },
            { "infinitive": "DEAL", "simple_past": "dealt", "past_participle": "dealt", "japanese_def": "[æ‰±ã†]", "sample_sentence": "They have dealt with the issue effectively." },
            { "infinitive": "DREAM", "simple_past": "dreamed", "past_participle": "dreamed", "japanese_def": "[å¤¢ã‚’è¦‹ã‚‹]", "sample_sentence": "I have dreamed of this moment." },
            { "infinitive": "FEED", "simple_past": "fed", "past_participle": "fed", "japanese_def": "[é£Ÿã¹ç‰©ã‚’ä¸ãˆã‚‹]", "sample_sentence": "The birds have been fed." },
            { "infinitive": "GRIND", "simple_past": "ground", "past_participle": "ground", "japanese_def": "[æŒ½ã]", "sample_sentence": "The coffee beans have been freshly ground." },
            { "infinitive": "HANG", "simple_past": "hung", "past_participle": "hung", "japanese_def": "[åŠã‚‹ã™]", "sample_sentence": "The picture has been hung too high." },
            { "infinitive": "SLIDE", "simple_past": "slid", "past_participle": "slid", "japanese_def": "[æ»‘ã‚‹]", "sample_sentence": "The cover slid open easily." }
        ]
    }
];


// =======================================================================
// PART 2: GAME LOGIC (The "Engine")
// =======================================================================

// *** IMPORTANT: Change the data source here ***
const GAME_DATA = IRREGULAR_GAME_DATA; 

let currentRoundIndex = 0;
let currentWordIndex = 0;
let totalScore = 0;
let roundScore = 0;
let currentWord = {};
let roundWordsPlayed = []; // Array to store results for the summary

const synth = window.speechSynthesis;
let voice = null; 

// --- ELEMENT SELECTORS ---
const views = {
    instructions: document.getElementById('instructions-view'),
    word: document.getElementById('current-word-view'),
    summary: document.getElementById('round-summary-view')
};
const els = {
    roundHeader: document.getElementById('round-header'),
    translation: document.getElementById('translation'),
    infinitiveDisplay: document.getElementById('infinitive-verb-display'),
    simplePastContainer: document.getElementById('simple-past-container'),
    simplePastDisplay: document.getElementById('simple-past-display'),
    pastParticipleContainer: document.getElementById('past-participle-container'),
    pastParticipleDisplay: document.getElementById('past-participle-display'),
    revealSimplePastButton: document.getElementById('reveal-simple-past-button'),
    revealPastParticipleButton: document.getElementById('reveal-past-participle-button'),
    feedbackButtons: document.getElementById('feedback-buttons'),
    roundScoreDisplay: document.getElementById('round-score-display'),
    totalScoreDisplay: document.getElementById('total-score-display'),
    roundSummary: document.getElementById('round-summary'),
    questionText: document.getElementById('question-text')
};


// Utility function for dynamic Text-to-Speech
function speakText(text) {
    if (synth.speaking) {
        synth.cancel();
    }
    const utterThis = new SpeechSynthesisUtterance(text);
    
    // Attempt to select an American English voice (or default)
    if (!voice) {
        const voices = synth.getVoices();
        voice = voices.find(v => v.lang.startsWith('en-US')) || voices[0];
    }
    if (voice) {
        utterThis.voice = voice;
    }
    utterThis.rate = 0.8; // Slightly slower speech for learning
    synth.speak(utterThis);
}

// Function to start the game (called by the initial button)
function startGame() {
    currentRoundIndex = 0;
    currentWordIndex = 0;
    totalScore = 0;
    roundScore = 0;
    roundWordsPlayed = [];
    els.totalScoreDisplay.textContent = totalScore;
    loadNextWord();
}

// Function to reset the view for a new word
function resetWordView() {
    els.infinitiveDisplay.classList.remove('hidden');
    els.revealSimplePastButton.classList.remove('hidden');
    
    // Hide all answer elements
    els.simplePastContainer.classList.add('hidden');
    els.pastParticipleContainer.classList.add('hidden');
    els.revealPastParticipleButton.classList.add('hidden');
    els.feedbackButtons.classList.add('hidden');
    
    // Reset display text
    els.simplePastDisplay.textContent = '...'; 
    els.pastParticipleDisplay.textContent = '...';
    
    els.questionText.innerHTML = `Click the verb to hear it. **What is its Simple Past form?**`;
}

// Function to reset display and load the next word
function loadNextWord() {
    if (currentRoundIndex >= GAME_DATA.length) {
        // Handle Game Over (Final Score Screen) - KEEPING THE REWARD GRAPHIC
        views.word.classList.add('hidden');
        views.summary.classList.add('hidden');
        
        document.getElementById('instructions-view').innerHTML = `
            <h2 style="color: #ffc0cb;">ä¸è¦å‰‡å‹•è©ãƒã‚¹ã‚¿ãƒ¼ï¼ ğŸ‘‘</h2>
            <div style="font-size: 80px; margin: 20px 0;">
                <span role="img" aria-label="Trophy">ğŸ†</span>
            </div>
            <p style="font-size: 1.5em; font-weight: bold; color: #e91e63;">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨${GAME_DATA.length}ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼</p>
            <div class="score-box" style="font-size: 2em; margin-top: 30px; padding: 15px; border: 3px solid #ffc0cb; border-radius: 10px;">
                æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="final-score-display">${totalScore.toFixed(1)}</span> ğŸ¥‡
            </div>
            <p style="margin-top: 25px; color: #555;">ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚Šã€åˆ¥ã®ã‚²ãƒ¼ãƒ ã«æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†ã€‚</p>
            <a href="index.html" style="text-decoration: none;">
                <button style="margin-top: 20px; background-color: #1e88e5; color: white;">ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
            </a>
        `;
        
        views.instructions.classList.remove('hidden');
        document.getElementById('total-score-display').textContent = totalScore.toFixed(1);
        return; 
    }

    const currentRound = GAME_DATA[currentRoundIndex];
    if (currentWordIndex >= currentRound.words.length) {
        showRoundSummary();
        return;
    }

    currentWord = currentRound.words[currentWordIndex];

    resetWordView();

    // --- NEW JAPANESE TEXT AND AUTO-AUDIO ---
    els.roundHeader.textContent = `ãƒ©ã‚¦ãƒ³ãƒ‰ ${currentRound.round_number}: å˜èª ${currentWordIndex + 1} / ${currentRound.words.length}`;
    els.translation.textContent = currentWord.japanese_def;
    els.infinitiveDisplay.textContent = currentWord.infinitive;
    els.questionText.textContent = 'ç¾åœ¨å½¢ãŒè‡ªå‹•çš„ã«å†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚ã€Œéå»å½¢ã€ã‚’è€ƒãˆã¦ãã ã•ã„ã€‚';

    // *** AUTOPLAY AUDIO HERE ***
    speakText(currentWord.infinitive); 
    
    views.instructions.classList.add('hidden');
    views.word.classList.remove('hidden');
    views.summary.classList.add('hidden');
}
        // --- START OF REWARD GRAPHIC UPDATE ---
        document.getElementById('instructions-view').innerHTML = `
            <h2 style="color: #e91e63;">Irregular Verb Master! ğŸ‘‘</h2>
            <div style="font-size: 80px; margin: 20px 0;">
                <span role="img" aria-label="Trophy">ğŸ†</span>
            </div>
            <p style="font-size: 1.5em; font-weight: bold; color: #388e3c;">Congratulations! You have completed all ${GAME_DATA.length} rounds and mastered 100 irregular verbs!</p>
            <div class="score-box" style="font-size: 2em; margin-top: 30px; padding: 15px; border: 3px solid #e91e63; border-radius: 10px;">
                Final Score: <span id="final-score-display">${totalScore.toFixed(1)}</span> ğŸ¥‡
            </div>
            <p style="margin-top: 25px; color: #555;">Refresh the page to play again or challenge yourself to reach a perfect 100 points!</p>
        `;
        // --- END OF REWARD GRAPHIC UPDATE ---
        
        views.instructions.classList.remove('hidden');
        return; 
    }

    const currentRound = GAME_DATA[currentRoundIndex];
    if (currentWordIndex >= currentRound.words.length) {
        showRoundSummary();
        return;
    }

    currentWord = currentRound.words[currentWordIndex];

    resetWordView();

    els.roundHeader.textContent = `Round ${currentRound.round_number}: Word ${currentWordIndex + 1} / ${currentRound.words.length}`;
    els.translation.textContent = currentWord.japanese_def;
    els.infinitiveDisplay.textContent = currentWord.infinitive;
    
    views.instructions.classList.add('hidden');
    views.word.classList.remove('hidden');
    views.summary.classList.add('hidden');
}

// Function called by the "Simple Past" button
function revealSimplePast() {
    els.revealSimplePastButton.classList.add('hidden');
    els.simplePastContainer.classList.remove('hidden');
    els.simplePastDisplay.textContent = currentWord.simple_past;
    
    speakText(currentWord.simple_past);

    // Update prompt and show next button
    els.simplePastContainer.querySelector('p').innerHTML = `**Next: What is the Past Participle form?**`;
    els.revealPastParticipleButton.classList.remove('hidden');
}

// Function called by the "Past Participle" button
function revealPastParticiple() {
    els.revealPastParticipleButton.classList.add('hidden');
    els.pastParticipleContainer.classList.remove('hidden');
    els.pastParticipleDisplay.textContent = currentWord.past_participle;

    speakText(currentWord.past_participle);

    // Show the feedback buttons
    els.feedbackButtons.classList.remove('hidden');
    els.questionText.innerHTML = `Did you know both forms? Select one to proceed.`;
}

// Function called by Yes/No/Not Sure buttons
function submitFeedback(score) {
    roundScore += score;
    totalScore += score;

    // Store the result for the summary screen
    roundWordsPlayed.push({
        infinitive: currentWord.infinitive,
        simple_past: currentWord.simple_past,
        past_participle: currentWord.past_participle,
        japanese_def: currentWord.japanese_def,
        sample_sentence: currentWord.sample_sentence,
        score: score
    });

    // Update score displays
    els.roundScoreDisplay.textContent = roundScore.toFixed(1);
    els.totalScoreDisplay.textContent = totalScore.toFixed(1);

    // Move to the next word
    currentWordIndex++;
    loadNextWord();
}

// Function to display the end-of-round summary
function showRoundSummary() {
    views.word.classList.add('hidden');
    views.summary.classList.remove('hidden');
    
    document.getElementById('summary-round-number').textContent = GAME_DATA[currentRoundIndex].round_number;
    els.roundScoreDisplay.textContent = roundScore.toFixed(1);

    // Generate the list of words for the summary
    let summaryHTML = '';
    roundWordsPlayed.forEach(word => {
        const check = word.score > 0 ? 'âœ…' : 'âŒ';
        summaryHTML += `
            <div class="summary-item" style="border-bottom: 1px dotted #e91e63; padding-bottom: 5px;">
                <strong>${check} ${word.infinitive}</strong>: ${word.simple_past}, ${word.past_participle}
                <br><span style="color: #6a1b9a; font-size: 0.9em;">(${word.japanese_def})</span>
                <br><em style="font-size: 0.9em;">Sentence: ${word.sample_sentence}</em>
            </div>
        `;
    });
    els.roundSummary.innerHTML = summaryHTML;
}

// Function to start the next round
function startNextRound() {
    currentRoundIndex++;
    currentWordIndex = 0;
    roundScore = 0;
    roundWordsPlayed = []; // Reset summary data
    loadNextWord();
}

// Initialize on page load to ensure voice is ready (important for TTS)
window.onload = function() {
    if (synth.getVoices().length === 0) {
        synth.onvoiceschanged = function() {
            voice = synth.getVoices().find(v => v.lang.startsWith('en-US')) || synth.getVoices()[0];
        };
    } else {
        voice = synth.getVoices().find(v => v.lang.startsWith('en-US')) || synth.getVoices()[0];
    }
};

// =======================================================================
// PART 3: ENTRY POINTS (Functions called by HTML)
// These functions already exist in the HTML structure: startGame, revealSimplePast, revealPastParticiple, submitFeedback, startNextRound
// =======================================================================
</script>
</body>
</html>
