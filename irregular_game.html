<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irregular Verb Master Game</title>
    <style>
        /* Base styles */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #e3f2fd; /* Soft Blue Background */
            margin: 0;
            text-align: center;
        }
        #game-container {
            background-color: #fff; /* White container background */
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #333;
            margin-bottom: 20px;
        }
        /* Verb Display */
        .verb-display {
            font-size: 2.5em;
            font-weight: bold;
            color: #ffc0cb; /* Sakura Pink */
            cursor: pointer;
            padding: 10px 20px;
            border: 2px solid #ffc0cb;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 10px;
            user-select: none;
            background-color: #fff;
        }
        .verb-display:active {
            transform: scale(0.98);
        }
        #translation {
            font-size: 1.2em;
            color: #555;
            margin-bottom: 20px;
        }
        #question-text {
            font-size: 1.1em;
            color: #777;
            margin-bottom: 25px;
        }
        .past-tense-reveal {
            font-size: 2em;
            font-weight: bold;
            color: #e91e63; /* Darker Pink for emphasis */
            cursor: pointer;
            padding: 5px 10px;
            display: inline-block;
            margin-top: 15px;
            border-bottom: 3px dashed #ffc0cb;
            user-select: none;
        }
        .past-tense-reveal:active {
            opacity: 0.8;
        }
        /* Button Styles */
        .button-group button,
        #reveal-button,
        #start-game-button,
        #round-summary-view button {
            background-color: #ffc0cb; /* Sakura Pink Button Color */
            color: #333; /* Dark text for contrast */
            border: none;
            padding: 12px 25px;
            margin: 5px;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .button-group button:hover,
        #reveal-button:hover,
        #start-game-button:hover,
        #round-summary-view button:hover {
            background-color: #f7a9b8;
        }
        /* Make specific buttons larger */
        #simple-past-reveal,
        #past-participle-reveal,
        #next-word-button,
        #start-game-button {
            padding: 15px 40px !important;
            font-size: 1.2em !important;
            font-weight: bold;
            min-width: 250px;
            margin-bottom: 10px;
        }
        #next-word-button {
            background-color: #1e88e5 !important; /* Blue for next word */
            color: white !important;
        }
        .score-box {
            margin-top: 20px;
            font-size: 1.2em;
            color: #333;
        }
        #round-summary {
            margin-top: 20px;
            text-align: left;
            padding: 15px;
            background-color: #f8f8f8; /* Light gray background for summary box */
            border-radius: 8px;
        }
        .summary-item {
            margin-bottom: 10px;
            font-size: 0.95em;
        }
        .hidden {
            display: none;
        }
        /* Style for Instructions screen */
        #instructions-view {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #instructions-view ul {
            list-style: none;
            padding-left: 0;
            max-width: 450px;
            margin: 0 auto 20px auto;
            text-align: left;
        }
        #instructions-view li {
            margin-bottom: 10px;
            line-height: 1.4;
        }
        .instruction-section {
            margin-bottom: 25px;
            text-align: center;
        }
        .instruction-title {
            font-weight: bold;
            color: #e91e63;
            margin-bottom: 10px;
            font-size: 1.1em;
            text-align: center;
        }
    </style>
</head>
<body>

<div id="game-container">
    
    <div id="instructions-view">
        <h2 style="color: #e91e63;">ä¸è¦å‰‡å‹•è©ãƒã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒ </h2>
        
        <div class="instruction-section">
            <div class="instruction-title">æ—¥æœ¬èªã§ã®éŠã³æ–¹:</div>
            <p>ã“ã®ã‚²ãƒ¼ãƒ ã¯ã€ä¸è¦å‰‡å‹•è©ã®éå»å½¢ã¨éå»åˆ†è©å½¢ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
            <p style="font-weight: bold;">10ãƒ©ã‚¦ãƒ³ãƒ‰ã§100å˜èªã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã™ã€‚</p>
            <ul>
                <li>ã‚¹ãƒ†ãƒƒãƒ—1: å˜èªãŒè‡ªå‹•çš„ã«å†ç”Ÿã•ã‚Œã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—2: éå»å½¢ã¨éå»åˆ†è©å½¢ã‚’è€ƒãˆã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—3: ã€ŒSimple Pastã€ã¨ã€ŒPast Participleã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</li>
                <li>ã‚¹ãƒ†ãƒƒãƒ—4: ã€ŒYes, No, Not Sureã€ã§å›ç­”ã—ã€ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã—ã¾ã™ã€‚</li>
                <li>ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†: ã‚¹ã‚³ã‚¢ã¨10å˜èªå…¨ã¦ã®ä¾‹æ–‡ã‚’ç¢ºèªã—ã¾ã™ã€‚</li>
            </ul>
        </div>
        
        <button id="start-game-button" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>

    <div id="current-word-view" class="hidden">
        <h2 id="round-header">ãƒ©ã‚¦ãƒ³ãƒ‰ 1: å˜èª 1 / 10</h2>
        
        <div id="translation">[æ—¥æœ¬èªã®æ„å‘³]</div>
        <div id="infinitive-display" class="verb-display" onclick="speakText(currentWord.infinitive)">INFINITIVE</div>
        <div id="question-text">ç¾åœ¨å½¢ãŒè‡ªå‹•çš„ã«å†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚ã€Œéå»å½¢ã€ã‚’è€ƒãˆã¦ãã ã•ã„ã€‚</div>
        
        <button id="simple-past-reveal" onclick="revealSimplePast()">Simple Past</button>
        <div id="simple-past-container" class="hidden">
            <div id="simple-past-display" class="past-tense-reveal" onclick="speakText(currentWord.simple_past)"></div>
            <p style="margin-top: 10px; color: #333;">æ€ã£ãŸé€šã‚Šã§ã—ãŸã‹ï¼Ÿ</p>
            <div id="simple-past-feedback" class="button-group">
                <button onclick="submitFeedback(1, 'past')">Yes <span id="reward-visual-past"></span></button>
                <button onclick="submitFeedback(0.5, 'past')">Not Sure</button>
                <button onclick="submitFeedback(0, 'past')">No</button>
            </div>
            <button id="past-participle-reveal" onclick="revealPastParticiple()" style="margin-top: 20px;">Past Participle</button>
        </div>
        
        <div id="past-participle-container" class="hidden">
            <div id="past-participle-display" class="past-tense-reveal" onclick="speakText(currentWord.past_participle)"></div>
            <p style="margin-top: 10px; color: #333;">æ€ã£ãŸé€šã‚Šã§ã—ãŸã‹ï¼Ÿ</p>
            <div id="past-participle-feedback" class="button-group">
                <button onclick="submitFeedback(1, 'participle')">Yes <span id="reward-visual-participle"></span></button>
                <button onclick="submitFeedback(0.5, 'participle')">Not Sure</button>
                <button onclick="submitFeedback(0, 'participle')">No</button>
            </div>
            <button id="next-word-button" onclick="goToNextWord()" style="margin-top: 20px;">æ¬¡ã®å˜èªã¸</button>
        </div>
        <div class="score-box">
            Total Score: <span id="total-score-display">0</span>
        </div>
    </div>

    <div id="round-summary-view" class="hidden">
        <h3>ãƒ©ã‚¦ãƒ³ãƒ‰ <span id="summary-round-number"></span> å®Œäº†ï¼</h3>
        <p>ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¹ã‚³ã‚¢: <span id="round-score-display">0</span></p>
        <p>å…¨å˜èªã®ãƒªã‚¹ãƒˆã¨ä¾‹æ–‡:</p>
        <div id="round-summary">
            </div>
        <button onclick="startNextRound()">æ¬¡ã®ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>
</div>


<script>

// =======================================================================
// PART 1: GAME DATA (The "Library")
// =======================================================================
const GAME_DATA = [
    {
        "round_number": 1,
        "words": [
            {
                "infinitive": "BE",
                "simple_past": "was were",
                "past_participle": "been",
                "category": "E",
                "japanese_def": "[ã§ã‚ã‚‹]",
                "sample_sentence": "She was here yesterday. They have been busy."
            },
            {
                "infinitive": "HAVE",
                "simple_past": "had",
                "past_participle": "had",
                "category": "E",
                "japanese_def": "[æŒã£ã¦ã„ã‚‹]",
                "sample_sentence": "I had a dog when I was young. He has had the car for years."
            },
            {
                "infinitive": "DO",
                "simple_past": "did",
                "past_participle": "done",
                "category": "E",
                "japanese_def": "[ã™ã‚‹]",
                "sample_sentence": "I did my homework. The work is done."
            },
            {
                "infinitive": "SAY",
                "simple_past": "said",
                "past_participle": "said",
                "category": "E",
                "japanese_def": "[è¨€ã†]",
                "sample_sentence": "He said goodbye. She has said that before."
            },
            {
                "infinitive": "GO",
                "simple_past": "went",
                "past_participle": "gone",
                "category": "E",
                "japanese_def": "[è¡Œã]",
                "sample_sentence": "We went to the beach. They have gone home."
            },
            {
                "infinitive": "GET",
                "simple_past": "got",
                "past_participle": "got/gotten",
                "category": "E",
                "japanese_def": "[å¾—ã‚‹]",
                "sample_sentence": "I got a new job. She has gotten better at tennis."
            },
            {
                "infinitive": "MAKE",
                "simple_past": "made",
                "past_participle": "made",
                "category": "E",
                "japanese_def": "[ä½œã‚‹]",
                "sample_sentence": "He made a cake. The dress was made of silk."
            },
            {
                "infinitive": "KNOW",
                "simple_past": "knew",
                "past_participle": "known",
                "category": "E",
                "japanese_def": "[çŸ¥ã£ã¦ã„ã‚‹]",
                "sample_sentence": "I knew the answer. It is a well-known fact."
            },
            {
                "infinitive": "THINK",
                "simple_past": "thought",
                "past_participle": "thought",
                "category": "E",
                "japanese_def": "[è€ƒãˆã‚‹]",
                "sample_sentence": "She thought about it. I have thought this through."
            },
            {
                "infinitive": "TAKE",
                "simple_past": "took",
                "past_participle": "taken",
                "category": "E",
                "japanese_def": "[å–ã‚‹]",
                "sample_sentence": "We took a break. The picture was taken yesterday."
            }
        ]
    },
    {
        "round_number": 2,
        "words": [
            {
                "infinitive": "SEE",
                "simple_past": "saw",
                "past_participle": "seen",
                "category": "E",
                "japanese_def": "[è¦‹ã‚‹]",
                "sample_sentence": "I saw a bird. We have seen this movie."
            },
            {
                "infinitive": "COME",
                "simple_past": "came",
                "past_participle": "come",
                "category": "E",
                "japanese_def": "[æ¥ã‚‹]",
                "sample_sentence": "He came home late. Has she come back yet?"
            },
            {
                "infinitive": "GIVE",
                "simple_past": "gave",
                "past_participle": "given",
                "category": "E",
                "japanese_def": "[ä¸ãˆã‚‹]",
                "sample_sentence": "They gave him a gift. The information was given to us."
            },
            {
                "infinitive": "FIND",
                "simple_past": "found",
                "past_participle": "found",
                "category": "E",
                "japanese_def": "[è¦‹ã¤ã‘ã‚‹]",
                "sample_sentence": "She found her keys. The lost puppy was found."
            },
            {
                "infinitive": "TELL",
                "simple_past": "told",
                "past_participle": "told",
                "category": "E",
                "japanese_def": "[æ•™ãˆã‚‹]",
                "sample_sentence": "I told him the truth. We have been told to wait."
            },
            {
                "infinitive": "PUT",
                "simple_past": "put",
                "past_participle": "put",
                "category": "E",
                "japanese_def": "[ç½®ã]",
                "sample_sentence": "She put the book down. The toys were put away."
            },
            {
                "infinitive": "MEAN",
                "simple_past": "meant",
                "past_participle": "meant",
                "category": "E",
                "japanese_def": "[æ„å‘³ã™ã‚‹]",
                "sample_sentence": "I meant what I said. The gesture was meant kindly."
            },
            {
                "infinitive": "BECOME",
                "simple_past": "became",
                "past_participle": "become",
                "category": "E",
                "japanese_def": "[ã«ãªã‚‹]",
                "sample_sentence": "He became a doctor. She has become very skilled."
            },
            {
                "infinitive": "LEAVE",
                "simple_past": "left",
                "past_participle": "left",
                "category": "E",
                "japanese_def": "[å»ã‚‹]",
                "sample_sentence": "They left the party early. The letter was left on the table."
            },
            {
                "infinitive": "BEGIN",
                "simple_past": "began",
                "past_participle": "begun",
                "category": "E",
                "japanese_def": "[å§‹ã‚ã‚‹]",
                "sample_sentence": "The concert began at eight. The project has begun."
            }
        ]
    },
    {
        "round_number": 3,
        "words": [
            {
                "infinitive": "SEEM",
                "simple_past": "seemed",
                "past_participle": "seemed",
                "category": "E",
                "japanese_def": "[ã€œã®ã‚ˆã†ã«è¦‹ãˆã‚‹]",
                "sample_sentence": "It seemed like a good idea. He seemed happy."
            },
            {
                "infinitive": "SHOW",
                "simple_past": "showed",
                "past_participle": "shown",
                "category": "E",
                "japanese_def": "[è¦‹ã›ã‚‹]",
                "sample_sentence": "She showed me her photo. The results have been shown."
            },
            {
                "infinitive": "HEAR",
                "simple_past": "heard",
                "past_participle": "heard",
                "category": "E",
                "japanese_def": "[èã]",
                "sample_sentence": "I heard a noise. Have you heard the news?"
            },
            {
                "infinitive": "RUN",
                "simple_past": "ran",
                "past_participle": "run",
                "category": "E",
                "japanese_def": "[èµ°ã‚‹]",
                "sample_sentence": "The dog ran away. He has run marathons."
            },
            {
                "infinitive": "BRING",
                "simple_past": "brought",
                "past_participle": "brought",
                "category": "E",
                "japanese_def": "[æŒã£ã¦ãã‚‹]",
                "sample_sentence": "She brought a bottle of wine. The matter was brought up."
            },
            {
                "infinitive": "WRITE",
                "simple_past": "wrote",
                "past_participle": "written",
                "category": "E",
                "japanese_def": "[æ›¸ã]",
                "sample_sentence": "He wrote a letter. The essay was written in an hour."
            },
            {
                "infinitive": "READ",
                "simple_past": "read",
                "past_participle": "read",
                "category": "E",
                "japanese_def": "[èª­ã‚€]",
                "sample_sentence": "I read the book last night. I have read that chapter."
            },
            {
                "infinitive": "SET",
                "simple_past": "set",
                "past_participle": "set",
                "category": "E",
                "japanese_def": "[è¨­å®šã™ã‚‹]",
                "sample_sentence": "We set a date for the meeting. The table has been set."
            },
            {
                "infinitive": "STAND",
                "simple_past": "stood",
                "past_participle": "stood",
                "category": "E",
                "japanese_def": "[ç«‹ã¤]",
                "sample_sentence": "She stood up quickly. The tower has stood for centuries."
            },
            {
                "infinitive": "LOSE",
                "simple_past": "lost",
                "past_participle": "lost",
                "category": "E",
                "japanese_def": "[å¤±ã†]",
                "sample_sentence": "I lost my phone. The key is lost."
            }
        ]
    },
    {
        "round_number": 4,
        "words": [
            {
                "infinitive": "PAY",
                "simple_past": "paid",
                "past_participle": "paid",
                "category": "E",
                "japanese_def": "[æ”¯æ‰•ã†]",
                "sample_sentence": "He paid the bill. The debt has been paid."
            },
            {
                "infinitive": "MEET",
                "simple_past": "met",
                "past_participle": "met",
                "category": "E",
                "japanese_def": "[ä¼šã†]",
                "sample_sentence": "We met them yesterday. I have met her before."
            },
            {
                "infinitive": "SIT",
                "simple_past": "sat",
                "past_participle": "sat",
                "category": "E",
                "japanese_def": "[åº§ã‚‹]",
                "sample_sentence": "She sat on the sofa. We have sat here for hours."
            },
            {
                "infinitive": "SPEAK",
                "simple_past": "spoke",
                "past_participle": "spoken",
                "category": "E",
                "japanese_def": "[è©±ã™]",
                "sample_sentence": "He spoke clearly. The words have been spoken."
            },
            {
                "infinitive": "LIE",
                "simple_past": "lay",
                "past_participle": "lain",
                "category": "E",
                "japanese_def": "[æ¨ªãŸã‚ã‚‹]",
                "sample_sentence": "The book lay on the desk. He has lain there all day."
            },
            {
                "infinitive": "LEAD",
                "simple_past": "led",
                "past_participle": "led",
                "category": "E",
                "japanese_def": "[å°ã]",
                "sample_sentence": "She led the team. The path has led to success."
            },
            {
                "infinitive": "LIVE",
                "simple_past": "lived",
                "past_participle": "lived",
                "category": "E",
                "japanese_def": "[ç”Ÿãã‚‹]",
                "sample_sentence": "They lived in Tokyo. We have lived here since 2000."
            },
            {
                "infinitive": "KEEP",
                "simple_past": "kept",
                "past_participle": "kept",
                "category": "E",
                "japanese_def": "[ä¿ã¤]",
                "sample_sentence": "I kept the secret. The promise has been kept."
            },
            {
                "infinitive": "FALL",
                "simple_past": "fell",
                "past_participle": "fallen",
                "category": "E",
                "japanese_def": "[è½ã¡ã‚‹]",
                "sample_sentence": "The rain fell quickly. She has fallen asleep."
            },
            {
                "infinitive": "SEND",
                "simple_past": "sent",
                "past_participle": "sent",
                "category": "E",
                "japanese_def": "[é€ã‚‹]",
                "sample_sentence": "He sent me a text. The package was sent yesterday."
            }
        ]
    },
    {
        "round_number": 5,
        "words": [
            {
                "infinitive": "BUILD",
                "simple_past": "built",
                "past_participle": "built",
                "category": "E",
                "japanese_def": "[å»ºã¦ã‚‹]",
                "sample_sentence": "They built a new house. The fence was built well."
            },
            {
                "infinitive": "HOLD",
                "simple_past": "held",
                "past_participle": "held",
                "category": "E",
                "japanese_def": "[æŒã¤]",
                "sample_sentence": "She held the door open. The meeting was held outside."
            },
            {
                "infinitive": "DRINK",
                "simple_past": "drank",
                "past_participle": "drunk",
                "category": "E",
                "japanese_def": "[é£²ã‚€]",
                "sample_sentence": "I drank too much coffee. He has drunk all the water."
            },
            {
                "infinitive": "BUY",
                "simple_past": "bought",
                "past_participle": "bought",
                "category": "E",
                "japanese_def": "[è²·ã†]",
                "sample_sentence": "We bought a new car. The tickets have been bought."
            },
            {
                "infinitive": "EAT",
                "simple_past": "ate",
                "past_participle": "eaten",
                "category": "E",
                "japanese_def": "[é£Ÿã¹ã‚‹]",
                "sample_sentence": "They ate dinner early. The cake has been eaten."
            },
            {
                "infinitive": "SLEEP",
                "simple_past": "slept",
                "past_participle": "slept",
                "category": "E",
                "japanese_def": "[å¯ã‚‹]",
                "sample_sentence": "I slept late. She has slept for nine hours."
            },
            {
                "infinitive": "CATCH",
                "simple_past": "caught",
                "past_participle": "caught",
                "category": "E",
                "japanese_def": "[æ•ã¾ãˆã‚‹]",
                "sample_sentence": "He caught the ball. The thief was caught."
            },
            {
                "infinitive": "FLY",
                "simple_past": "flew",
                "past_participle": "flown",
                "category": "E",
                "japanese_def": "[é£›ã¶]",
                "sample_sentence": "The bird flew away. We have flown that route before."
            },
            {
                "infinitive": "TEACH",
                "simple_past": "taught",
                "past_participle": "taught",
                "category": "E",
                "japanese_def": "[æ•™ãˆã‚‹]",
                "sample_sentence": "She taught English. The lesson was taught well."
            },
            {
                "infinitive": "HIT",
                "simple_past": "hit",
                "past_participle": "hit",
                "category": "E",
                "japanese_def": "[æ‰“ã¤]",
                "sample_sentence": "He hit the ball hard. The car was hit from behind."
            }
        ]
    },
    {
        "round_number": 6,
        "words": [
            {
                "infinitive": "DRIVE",
                "simple_past": "drove",
                "past_participle": "driven",
                "category": "E",
                "japanese_def": "[é‹è»¢ã™ã‚‹]",
                "sample_sentence": "I drove to work. We have driven across the country."
            },
            {
                "infinitive": "WEAR",
                "simple_past": "wore",
                "past_participle": "worn",
                "category": "E",
                "japanese_def": "[ç€ã‚‹]",
                "sample_sentence": "She wore a red dress. The clothes were worn out."
            },
            {
                "infinitive": "DRAW",
                "simple_past": "drew",
                "past_participle": "drawn",
                "category": "E",
                "japanese_def": "[æã]",
                "sample_sentence": "He drew a picture. The curtains were drawn."
            },
            {
                "infinitive": "SPEND",
                "simple_past": "spent",
                "past_participle": "spent",
                "category": "E",
                "japanese_def": "[è²»ã‚„ã™]",
                "sample_sentence": "We spent all day hiking. The money was spent quickly."
            },
            {
                "infinitive": "RISE",
                "simple_past": "rose",
                "past_participle": "risen",
                "category": "E",
                "japanese_def": "[ä¸ŠãŒã‚‹]",
                "sample_sentence": "The sun rose early. Prices have risen sharply."
            },
            {
                "infinitive": "SELL",
                "simple_past": "sold",
                "past_participle": "sold",
                "category": "E",
                "japanese_def": "[å£²ã‚‹]",
                "sample_sentence": "They sold their house. The items were sold out."
            },
            {
                "infinitive": "WAKE",
                "simple_past": "woke",
                "past_participle": "woken",
                "category": "E",
                "japanese_def": "[ç›®ã‚’è¦šã¾ã™]",
                "sample_sentence": "I woke up at seven. I was woken by a noise."
            },
            {
                "infinitive": "WIN",
                "simple_past": "won",
                "past_participle": "won",
                "category": "E",
                "japanese_def": "[å‹ã¤]",
                "sample_sentence": "She won the race. The trophy has been won."
            },
            {
                "infinitive": "FORGET",
                "simple_past": "forgot",
                "past_participle": "forgotten",
                "category": "E",
                "japanese_def": "[å¿˜ã‚Œã‚‹]",
                "sample_sentence": "I forgot his name. It has been forgotten."
            },
            {
                "infinitive": "SWIM",
                "simple_past": "swam",
                "past_participle": "swum",
                "category": "E",
                "japanese_def": "[æ³³ã]",
                "sample_sentence": "We swam in the lake. He has swum that far before."
            }
        ]
    },
    {
        "round_number": 7,
        "words": [
            {
                "infinitive": "FREEZE",
                "simple_past": "froze",
                "past_participle": "frozen",
                "category": "L",
                "japanese_def": "[å‡ã‚‹]",
                "sample_sentence": "The water froze overnight. The food was frozen."
            },
            {
                "infinitive": "HANG",
                "simple_past": "hung",
                "past_participle": "hung",
                "category": "L",
                "japanese_def": "[åŠã‚‹ã™]",
                "sample_sentence": "I hung the picture up. The laundry was hung out."
            },
            {
                "infinitive": "SHAKE",
                "simple_past": "shook",
                "past_participle": "shaken",
                "category": "L",
                "japanese_def": "[æŒ¯ã‚‹]",
                "sample_sentence": "He shook my hand. She was shaken by the news."
            },
            {
                "infinitive": "WIND",
                "simple_past": "wound",
                "past_participle": "wound",
                "category": "L",
                "japanese_def": "[å·»ã]",
                "sample_sentence": "She wound the thread. The watch needs to be wound."
            },
            {
                "infinitive": "TEAR",
                "simple_past": "tore",
                "past_participle": "torn",
                "category": "L",
                "japanese_def": "[ç ´ã‚‹]",
                "sample_sentence": "I tore the paper. The book was torn."
            },
            {
                "infinitive": "RING",
                "simple_past": "rang",
                "past_participle": "rung",
                "category": "L",
                "japanese_def": "[é³´ã‚‹]",
                "sample_sentence": "The phone rang loudly. The bell has rung."
            },
            {
                "infinitive": "SHINE",
                "simple_past": "shone",
                "past_participle": "shone",
                "category": "L",
                "japanese_def": "[è¼ã]",
                "sample_sentence": "The sun shone brightly. The polished metal shone."
            },
            {
                "infinitive": "BEAT",
                "simple_past": "beat",
                "past_participle": "beaten",
                "category": "L",
                "japanese_def": "[æ‰“ã¤]",
                "sample_sentence": "She beat the drum. The team was beaten badly."
            },
            {
                "infinitive": "BITE",
                "simple_past": "bit",
                "past_participle": "bitten",
                "category": "L",
                "japanese_def": "[å™›ã‚€]",
                "sample_sentence": "The dog bit the mailman. I have been bitten by a mosquito."
            },
            {
                "infinitive": "BLOW",
                "simple_past": "blew",
                "past_participle": "blown",
                "category": "L",
                "japanese_def": "[å¹ã]",
                "sample_sentence": "The wind blew hard. The leaves were blown away."
            }
        ]
    },
    {
        "round_number": 8,
        "words": [
            {
                "infinitive": "HIDE",
                "simple_past": "hid",
                "past_participle": "hidden",
                "category": "L",
                "japanese_def": "[éš ã™]",
                "sample_sentence": "She hid the money. The truth was hidden from us."
            },
            {
                "infinitive": "CHOOSE",
                "simple_past": "chose",
                "past_participle": "chosen",
                "category": "L",
                "japanese_def": "[é¸ã¶]",
                "sample_sentence": "I chose the blue one. The winner has been chosen."
            },
            {
                "infinitive": "DEAL",
                "simple_past": "dealt",
                "past_participle": "dealt",
                "category": "L",
                "japanese_def": "[æ‰±ã†]",
                "sample_sentence": "They dealt with the problem. I have dealt with him before."
            },
            {
                "infinitive": "FIGHT",
                "simple_past": "fought",
                "past_participle": "fought",
                "category": "L",
                "japanese_def": "[æˆ¦ã†]",
                "sample_sentence": "The soldiers fought bravely. The battle was fought long ago."
            },
            {
                "infinitive": "GROW",
                "simple_past": "grew",
                "past_participle": "grown",
                "category": "L",
                "japanese_def": "[è‚²ã¤]",
                "sample_sentence": "The plant grew fast. The economy has grown."
            },
            {
                "infinitive": "THROW",
                "simple_past": "threw",
                "past_participle": "thrown",
                "category": "L",
                "japanese_def": "[æŠ•ã’ã‚‹]",
                "sample_sentence": "He threw the ball. The towel was thrown in."
            },
            {
                "infinitive": "SHOOT",
                "simple_past": "shot",
                "past_participle": "shot",
                "category": "L",
                "japanese_def": "[æ’ƒã¤]",
                "sample_sentence": "The hunter shot a deer. The scene was shot on location."
            },
            {
                "infinitive": "FORBID",
                "simple_past": "forbade",
                "past_participle": "forbidden",
                "category": "L",
                "japanese_def": "[ç¦ã˜ã‚‹]",
                "sample_sentence": "My parents forbade me to go. It is forbidden to enter."
            },
            {
                "infinitive": "FORGIVE",
                "simple_past": "forgave",
                "past_participle": "forgiven",
                "category": "L",
                "japanese_def": "[è¨±ã™]",
                "sample_sentence": "She forgave him immediately. The sin has been forgiven."
            },
            {
                "infinitive": "FORSAKE",
                "simple_past": "forsook",
                "past_participle": "forsaken",
                "category": "L",
                "japanese_def": "[è¦‹æ¨ã¦ã‚‹]",
                "sample_sentence": "He forsook his friends. They felt forsaken."
            }
        ]
    },
    {
        "round_number": 9,
        "words": [
            {
                "infinitive": "HURT",
                "simple_past": "hurt",
                "past_participle": "hurt",
                "category": "L",
                "japanese_def": "[å‚·ã¤ã‘ã‚‹]",
                "sample_sentence": "I hurt my knee. My feelings were hurt."
            },
            {
                "infinitive": "SHUT",
                "simple_past": "shut",
                "past_participle": "shut",
                "category": "L",
                "japanese_def": "[é–‰ã‚ã‚‹]",
                "sample_sentence": "He shut the door. The business was shut down."
            },
            {
                "infinitive": "SING",
                "simple_past": "sang",
                "past_participle": "sung",
                "category": "L",
                "japanese_def": "[æ­Œã†]",
                "sample_sentence": "She sang a beautiful song. The song has been sung."
            },
            {
                "infinitive": "STING",
                "simple_past": "stung",
                "past_participle": "stung",
                "category": "L",
                "japanese_def": "[åˆºã™]",
                "sample_sentence": "A bee stung me. I was stung by a nettle."
            },
            {
                "infinitive": "STRIKE",
                "simple_past": "struck",
                "past_participle": "struck",
                "category": "L",
                "japanese_def": "[æ‰“ã¤]",
                "sample_sentence": "Lightning struck the tree. We were struck by his honesty."
            },
            {
                "infinitive": "SWEAR",
                "simple_past": "swore",
                "past_participle": "sworn",
                "category": "L",
                "japanese_def": "[èª“ã†]",
                "sample_sentence": "He swore an oath. She has sworn to tell the truth."
            },
            {
                "infinitive": "SWELL",
                "simple_past": "swelled",
                "past_participle": "swollen",
                "category": "L",
                "japanese_def": "[è†¨ã‚‰ã‚€]",
                "sample_sentence": "My ankle swelled up. His eyes were swollen."
            },
            {
                "infinitive": "CROW",
                "simple_past": "crew",
                "past_participle": "crowed",
                "category": "L",
                "japanese_def": "[é³´ã (é¶)]",
                "sample_sentence": "The rooster crew early. The champion crowed about his win."
            },
            {
                "infinitive": "DIVE",
                "simple_past": "dove/dived",
                "past_participle": "dived",
                "category": "L",
                "japanese_def": "[é£›ã³è¾¼ã‚€]",
                "sample_sentence": "He dove into the pool. She has dived off the board."
            },
            {
                "infinitive": "SINK",
                "simple_past": "sank",
                "past_participle": "sunk",
                "category": "L",
                "japanese_def": "[æ²ˆã‚€]",
                "sample_sentence": "The ship sank quickly. The stone had sunk to the bottom."
            }
        ]
    },
    {
        "round_number": 10,
        "words": [
            {
                "infinitive": "SPIN",
                "simple_past": "spun",
                "past_participle": "spun",
                "category": "L",
                "japanese_def": "[å›è»¢ã™ã‚‹]",
                "sample_sentence": "The wheel spun fast. The story was spun quickly."
            },
            {
                "infinitive": "SPILL",
                "simple_past": "spilled/spilt",
                "past_participle": "spilled/spilt",
                "category": "L",
                "japanese_def": "[ã“ã¼ã™]",
                "sample_sentence": "I spilled my milk. The water has been spilt."
            },
            {
                "infinitive": "SPREAD",
                "simple_past": "spread",
                "past_participle": "spread",
                "category": "L",
                "japanese_def": "[åºƒãŒã‚‹]",
                "sample_sentence": "The fire spread fast. The news was spread quickly."
            },
            {
                "infinitive": "SPRING",
                "simple_past": "sprang",
                "past_participle": "sprung",
                "category": "L",
                "japanese_def": "[é£›ã³å‡ºã™]",
                "sample_sentence": "He sprang into action. The trap was sprung."
            },
            {
                "infinitive": "STEAL",
                "simple_past": "stole",
                "past_participle": "stolen",
                "category": "L",
                "japanese_def": "[ç›—ã‚€]",
                "sample_sentence": "Someone stole my bike. The car was stolen."
            },
            {
                "infinitive": "STICK",
                "simple_past": "stuck",
                "past_participle": "stuck",
                "category": "L",
                "japanese_def": "[çªãåˆºã™]",
                "sample_sentence": "The key stuck in the lock. We were stuck in traffic."
            },
            {
                "infinitive": "SMELL",
                "simple_past": "smelled/smelt",
                "past_participle": "smelled/smelt",
                "category": "L",
                "japanese_def": "[åŒ‚ã„ã‚’å—…ã]",
                "sample_sentence": "I smelled smoke. The food smelled bad."
            },
            {
                "infinitive": "STINK",
                "simple_past": "stank",
                "past_participle": "stunk",
                "category": "L",
                "japanese_def": "[æ‚ªè‡­ã‚’æ”¾ã¤]",
                "sample_sentence": "The milk stank. The place had stunk for days."
            },
            {
                "infinitive": "STREW",
                "simple_past": "strewed",
                "past_participle": "strewn",
                "category": "L",
                "japanese_def": "[æ•£ã‚‰ã™]",
                "sample_sentence": "He strewed the papers. The leaves were strewn."
            },
            {
                "infinitive": "STRING",
                "simple_past": "strung",
                "past_participle": "strung",
                "category": "L",
                "japanese_def": "[ã²ã‚‚ã‚’é€šã™]",
                "sample_sentence": "She strung the beads. The guitar was strung."
            }
        ]
    }
];

// =======================================================================
// PART 2: GAME LOGIC (The "Engine")
// =======================================================================

let currentRoundIndex = 0;
let currentWordIndex = 0;
let totalScore = 0;
let roundScore = 0;
let currentWord = {};

const synth = window.speechSynthesis;
let voice = null;
let lastFeedbackType = null; // Tracks 'past' or 'participle'

// Helper object for easier DOM access
const views = {
    instructions: document.getElementById('instructions-view'),
    word: document.getElementById('current-word-view'),
    summary: document.getElementById('round-summary-view')
};

const els = {
    roundHeader: document.getElementById('round-header'),
    translation: document.getElementById('translation'),
    infinitiveDisplay: document.getElementById('infinitive-display'),
    questionText: document.getElementById('question-text'),
    
    simplePastReveal: document.getElementById('simple-past-reveal'),
    simplePastContainer: document.getElementById('simple-past-container'),
    simplePastDisplay: document.getElementById('simple-past-display'),
    
    pastParticipleReveal: document.getElementById('past-participle-reveal'),
    pastParticipleContainer: document.getElementById('past-participle-container'),
    pastParticipleDisplay: document.getElementById('past-participle-display'),
    
    nextWordButton: document.getElementById('next-word-button'),
    totalScoreDisplay: document.getElementById('total-score-display'),

    rewardVisualPast: document.getElementById('reward-visual-past'),
    rewardVisualParticiple: document.getElementById('reward-visual-participle')
};

// Utility function for dynamic Text-to-Speech
function speakText(text) {
    if (synth.speaking) {
        synth.cancel();
    }
    const utterThis = new SpeechSynthesisUtterance(text);
    
    if (voice) {
        utterThis.voice = voice;
    }
    
    utterThis.lang = 'en-US';
    utterThis.rate = 0.9;
    synth.speak(utterThis);
}

// Function to find the American English voice
function findAmericanVoice() {
    const voices = synth.getVoices();
    voice = voices.find(v => v.lang === 'en-US' && v.name.includes('Google')) ||
            voices.find(v => v.lang === 'en-US');
}

// Function to hide instructions and start the game
function startGame() {
    // Hide instructions and show the word view
    views.instructions.classList.add('hidden');
    views.word.classList.remove('hidden');

    // Reset game state and load the first word
    currentRoundIndex = 0;
    currentWordIndex = 0;
    totalScore = 0;
    roundScore = 0;
    loadNextWord();
}

// Function to reset the display for a new word
function resetWordView() {
    // Reset visibility of reveal/feedback sections
    els.simplePastReveal.classList.remove('hidden');
    els.simplePastContainer.classList.add('hidden');
    els.pastParticipleReveal.classList.add('hidden');
    els.pastParticipleContainer.classList.add('hidden');
    els.nextWordButton.classList.add('hidden');
    
    // Clear reward visuals
    els.rewardVisualPast.textContent = '';
    els.rewardVisualParticiple.textContent = '';
    
    // Update score display
    els.totalScoreDisplay.textContent = totalScore.toFixed(1);
}

// Function to reset display and load the next word
function loadNextWord() {
    if (currentRoundIndex >= GAME_DATA.length) {
        // Handle Game Over (Final Score Screen) - UPDATED REWARD GRAPHIC
        views.word.classList.add('hidden');
        views.summary.classList.add('hidden');
        
        document.getElementById('instructions-view').innerHTML = `
            <h2 style="color: #ffc0cb;">ä¸è¦å‰‡å‹•è©ãƒã‚¹ã‚¿ãƒ¼ï¼ ğŸ‘‘</h2>
            <div style="font-size: 80px; margin: 20px 0;">
                <span role="img" aria-label="Trophy">ğŸ†</span>
            </div>
            <p style="font-size: 1.5em; font-weight: bold; color: #e91e63;">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨${GAME_DATA.length}ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼</p>
            <div class="score-box" style="font-size: 2em; margin-top: 30px; padding: 15px; border: 3px solid #ffc0cb; border-radius: 10px;">
                æœ€çµ‚ã‚¹ã‚³ã‚¢: <span id="final-score-display">${totalScore.toFixed(1)}</span> ğŸ¥‡
            </div>
            <p style="margin-top: 25px; color: #555;">ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚Šã€åˆ¥ã®ã‚²ãƒ¼ãƒ ã«æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†ã€‚</p>
            <a href="index.html" style="text-decoration: none;">
                <button style="margin-top: 20px; background-color: #ffc0cb; color: #333;">ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹</button>
            </a>
        `;
        
        views.instructions.classList.remove('hidden');
        document.getElementById('total-score-display').textContent = totalScore.toFixed(1);
        return; 
    }

    const currentRound = GAME_DATA[currentRoundIndex];
    if (currentWordIndex >= currentRound.words.length) {
        showRoundSummary();
        return;
    }

    currentWord = currentRound.words[currentWordIndex];

    resetWordView();

    // Update headers and displays
    els.roundHeader.textContent = `ãƒ©ã‚¦ãƒ³ãƒ‰ ${currentRound.round_number}: å˜èª ${currentWordIndex + 1} / ${currentRound.words.length}`;
    els.translation.textContent = currentWord.japanese_def;
    els.infinitiveDisplay.textContent = currentWord.infinitive;
    els.questionText.textContent = 'ç¾åœ¨å½¢ãŒè‡ªå‹•çš„ã«å†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚ã€Œéå»å½¢ã€ã‚’è€ƒãˆã¦ãã ã•ã„ã€‚';

    // *** AUTOPLAY AUDIO HERE (Consistency with Regular Game) ***
    speakText(currentWord.infinitive); 
    
    views.instructions.classList.add('hidden');
    views.word.classList.remove('hidden');
    views.summary.classList.add('hidden');
}

// Function to reveal the Simple Past form
function revealSimplePast() {
    els.simplePastReveal.classList.add('hidden');
    els.simplePastContainer.classList.remove('hidden');
    els.pastParticipleReveal.classList.add('hidden'); // Ensure this is still hidden

    // Update question text to show the result
    els.questionText.textContent = 'éå»å½¢ã¯:'; 
    
    els.simplePastDisplay.textContent = currentWord.simple_past;
    
    // Speak the correct past tense
    speakText(currentWord.simple_past);
}

// Function to reveal the Past Participle form (only called after Simple Past feedback)
function revealPastParticiple() {
    // Hide the Simple Past elements
    els.simplePastContainer.classList.add('hidden');
    
    // Show the Past Participle elements
    els.pastParticipleReveal.classList.add('hidden'); // Hide the button itself
    els.pastParticipleContainer.classList.remove('hidden');
    els.nextWordButton.classList.add('hidden');
    
    // Set the prompt for the participle
    els.questionText.textContent = 'éå»åˆ†è©å½¢ã‚’è€ƒãˆã¦ãã ã•ã„ã€‚';

    els.pastParticipleDisplay.textContent = currentWord.past_participle;
    
    // Speak the correct participle
    speakText(currentWord.past_participle);
}

// Function to handle the user's feedback for either form
function submitFeedback(points, type) {
    const rewardVisual = (type === 'past') ? els.rewardVisualPast : els.rewardVisualParticiple;
    let message = '';

    if (points === 1) {
        message = 'YES! That was perfect. ğŸ¥³';
        rewardVisual.textContent = 'âœ¨';
    } else if (points === 0.5) {
        message = 'Okay, getting closer! Half a coin. ğŸ¤”';
        rewardVisual.textContent = 'ğŸª™/2';
    } else {
        message = 'It\'s okay! Listen to the correct pronunciation again.';
        rewardVisual.textContent = 'âŒ';
    }

    // Add score
    totalScore += points;
    roundScore += points;
    els.totalScoreDisplay.textContent = totalScore.toFixed(1);

    // Update question text
    els.questionText.textContent = message;

    // Handle button visibility based on the feedback type
    if (type === 'past') {
        // After past tense feedback, show the past participle reveal button
        els.simplePastContainer.classList.add('hidden');
        els.pastParticipleReveal.classList.remove('hidden');
    } else {
        // After participle feedback, show the next word button
        els.pastParticipleContainer.classList.add('hidden');
        els.nextWordButton.classList.remove('hidden');
    }
}

// Function to move to the next word (called after final feedback)
function goToNextWord() {
    currentWordIndex++;
    loadNextWord();
}

// Function to display the round summary
function showRoundSummary() {
    views.word.classList.add('hidden');
    views.summary.classList.remove('hidden');

    const roundData = GAME_DATA[currentRoundIndex];
    document.getElementById('summary-round-number').textContent = roundData.round_number;
    document.getElementById('round-score-display').textContent = roundScore.toFixed(1);

    const summaryList = document.getElementById('round-summary');
    summaryList.innerHTML = ''; // Clear previous summary

    roundData.words.forEach(word => {
        const item = document.createElement('div');
        item.className = 'summary-item';
        item.innerHTML = `
            <strong>${word.infinitive} &rarr; ${word.simple_past} &rarr; ${word.past_participle}</strong>:
            ${word.sample_sentence}
        `;
        summaryList.appendChild(item);
    });
}

// Function to start the next round
function startNextRound() {
    currentRoundIndex++;
    currentWordIndex = 0;
    roundScore = 0;
    
    // The Game Over check is now handled at the start of loadNextWord
    loadNextWord();
}

// Initialization
window.onload = function() {
    // 1. Load voices when the page loads
    if (synth.getVoices().length === 0) {
        synth.onvoiceschanged = findAmericanVoice;
    } else {
        findAmericanVoice();
    }
};

</script>
</body>
</html>
